//Spoilzr API CLIENT
var request = require('request');

//Endpoints
var REST_ROOT = 'http://82.224.220.175:9001/api/';

var Spoilzr = function () {
	//config with pair of keys
}

function parseBody (err, data, response, callback) {
  if (err) callback(err, data);

  if (data && data.responseCode >= 400) callback(data.responseCode, data);
  else {
    try {
      var parsedBody = JSON.parse(data.body);
    }
    catch (e) {
      return callback(e, data);
    }

    callback(err, data, parsedBody);
  }
}

Spoilzr.prototype = {
  get: function (path, params, callback) {
  	return request.get(
  		REST_ROOT + path,
  		params,
      function (err, data, response) {
        parseBody(err, data, response, callback);
      }
  	);
  },
  post: function (path, params, callback) {
    return request.post(
  		REST_ROOT + path,
  		params,
      function (err, data, response) {
        parseBody(err, data, response, callback);
      }
  	);
  }
}

module.exports = Spoilzr;
